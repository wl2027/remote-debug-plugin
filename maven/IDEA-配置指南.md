# IDEA è¿œç¨‹è°ƒè¯•é…ç½®æŒ‡å—

## âš ï¸ å¸¸è§é”™è¯¯

### é”™è¯¯ 1: ä½¿ç”¨ "Application" é…ç½®è¿è¡Œ demo-app

**ç°è±¡**ï¼š
```
-agentlib:jdwp=...,server=n  â† é”™è¯¯çš„å‚æ•°
è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ä¸º 130 (interrupted by signal 2:SIGINT)
```

**åŸå› **ï¼š
- è¿™æ˜¯ IDEA çš„**æœ¬åœ°è°ƒè¯•æ¨¡å¼**
- IDEA å¯åŠ¨å¹¶æ§åˆ¶åº”ç”¨
- IDEA æ–­å¼€æ—¶ï¼Œåº”ç”¨ä¹Ÿä¼šé€€å‡º

**è§£å†³**ï¼š
- âŒ ä¸è¦ä½¿ç”¨ "Application" é…ç½®
- âœ… ä½¿ç”¨ "Remote JVM Debug" é…ç½®

---

## âœ… æ­£ç¡®é…ç½®æ­¥éª¤

### æ­¥éª¤ 1: åˆ é™¤é”™è¯¯çš„é…ç½®

1. æ‰“å¼€ IDEA
2. ç‚¹å‡»å³ä¸Šè§’çš„è¿è¡Œé…ç½®ä¸‹æ‹‰èœå•
3. ç‚¹å‡» **Edit Configurations...**
4. æ‰¾åˆ°æ‰€æœ‰ **Application** ç±»å‹çš„ DemoApplication é…ç½®
5. é€‰ä¸­å¹¶ç‚¹å‡» **-** å·åˆ é™¤

### æ­¥éª¤ 2: åˆ›å»º Remote JVM Debug é…ç½®

#### 2.1 æ·»åŠ æ–°é…ç½®

1. åœ¨ **Run/Debug Configurations** çª—å£
2. ç‚¹å‡»å·¦ä¸Šè§’çš„ **+** å·
3. é€‰æ‹© **Remote JVM Debug**

#### 2.2 é…ç½®å‚æ•°

å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Name: Remote Debug - Demo App via Proxy        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ Configuration                                   â”‚
â”‚                                                 â”‚
â”‚ Debugger mode:                                  â”‚
â”‚   â˜‘ Attach to remote JVM                       â”‚
â”‚                                                 â”‚
â”‚ Transport: Socket                               â”‚
â”‚                                                 â”‚
â”‚ Host: localhost                                 â”‚
â”‚                                                 â”‚
â”‚ Port: 15005                                     â”‚
â”‚                                                 â”‚
â”‚ Use module classpath: demo-app                  â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ Command line arguments for running remote JVM: â”‚
â”‚ ï¼ˆè¿™é‡Œä¼šè‡ªåŠ¨ç”Ÿæˆå‚è€ƒå‘½ä»¤ï¼Œä»…ä¾›å‚è€ƒï¼‰              â”‚
â”‚                                                 â”‚
â”‚ -agentlib:jdwp=transport=dt_socket,             â”‚
â”‚   server=y,suspend=n,address=15005              â”‚
â”‚                                                 â”‚
â”‚ âš ï¸ æ³¨æ„ï¼šè¿™åªæ˜¯æ˜¾ç¤ºï¼Œå®é™…ä¸éœ€è¦æ‰‹åŠ¨é…ç½®         â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.3 ä¿å­˜é…ç½®

1. ç‚¹å‡» **Apply**
2. ç‚¹å‡» **OK**

---

## ğŸš€ æ­£ç¡®çš„ä½¿ç”¨æµç¨‹

### æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ­¥éª¤ 1: åœ¨ç»ˆç«¯å¯åŠ¨ç»„ä»¶                    â”‚
â”‚         ï¼ˆä¸åœ¨ IDEA ä¸­ï¼ï¼‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»ˆç«¯æ‰§è¡Œï¼š./start-all.sh                        â”‚
â”‚                                                 â”‚
â”‚  æˆ–åˆ†åˆ«å¯åŠ¨ï¼š                                    â”‚
â”‚  â€¢ demo-app (JDWP port 15006, server=y)        â”‚
â”‚  â€¢ proxy-server (port 18888)                   â”‚
â”‚  â€¢ proxy-client (port 15005)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ­¥éª¤ 2: éªŒè¯ç»„ä»¶è¿è¡Œ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»ˆç«¯æ‰§è¡Œï¼š./check-status.sh                     â”‚
â”‚                                                 â”‚
â”‚  ç¡®è®¤ï¼š                                          â”‚
â”‚  âœ“ Demo App (PID: xxxxx) - è¿è¡Œä¸­              â”‚
â”‚  âœ“ Proxy Server - è¿è¡Œä¸­                        â”‚
â”‚  âœ“ Proxy Client - è¿è¡Œä¸­                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ­¥éª¤ 3: åœ¨ IDEA ä¸­è¿æ¥                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. æ‰“å¼€ demo-app çš„æºä»£ç                         â”‚
â”‚  2. åœ¨ä»£ç ä¸­è®¾ç½®æ–­ç‚¹                              â”‚
â”‚  3. ç‚¹å‡» Debug æŒ‰é’®ï¼ˆç»¿è‰²è™«å­å›¾æ ‡ï¼‰               â”‚
â”‚  4. é€‰æ‹© "Remote Debug - Demo App via Proxy"   â”‚
â”‚  5. ç­‰å¾…è¿æ¥æˆåŠŸ                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ­¥éª¤ 4: å¼€å§‹è°ƒè¯•                          â”‚
â”‚                                                 â”‚
â”‚  â€¢ ç­‰å¾…æ–­ç‚¹å‘½ä¸­                                  â”‚
â”‚  â€¢ æŸ¥çœ‹å˜é‡                                      â”‚
â”‚  â€¢ å•æ­¥æ‰§è¡Œ                                      â”‚
â”‚  â€¢ ç»§ç»­è¿è¡Œ                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### âŒ ä¸è¦è¿™æ ·åš

1. **ä¸è¦åœ¨ IDEA ä¸­ç›´æ¥è¿è¡Œ demo-app**
   - ä¸è¦ç‚¹å‡»ç»¿è‰²çš„ Run æŒ‰é’®
   - ä¸è¦ä½¿ç”¨ Application é…ç½®
   
2. **ä¸è¦è®© IDEA å¯åŠ¨åº”ç”¨**
   - demo-app åº”è¯¥åœ¨ç»ˆç«¯å¯åŠ¨
   - IDEA åªæ˜¯è¿æ¥ï¼Œä¸å¯åŠ¨

3. **ä¸è¦ä½¿ç”¨é”™è¯¯çš„è°ƒè¯•æ¨¡å¼**
   - `server=n` æ˜¯æœ¬åœ°è°ƒè¯•ï¼ˆé”™è¯¯ï¼‰
   - `server=y` æ˜¯è¿œç¨‹è°ƒè¯•ï¼ˆæ­£ç¡®ï¼‰

### âœ… è¦è¿™æ ·åš

1. **åœ¨ç»ˆç«¯å¯åŠ¨æ‰€æœ‰ç»„ä»¶**
   ```bash
   ./start-all.sh
   ```

2. **éªŒè¯ç»„ä»¶è¿è¡Œ**
   ```bash
   ./check-status.sh
   ```

3. **åœ¨ IDEA ä¸­åªä½¿ç”¨ Debug**
   - ä½¿ç”¨ Remote JVM Debug é…ç½®
   - è¿æ¥åˆ° localhost:15005

4. **æŸ¥çœ‹åº”ç”¨è¾“å‡º**
   ```bash
   tail -f /tmp/demo-app.log
   ```

---

## ğŸ” å¦‚ä½•è¯†åˆ«é…ç½®æ˜¯å¦æ­£ç¡®

### æ£€æŸ¥ IDEA é…ç½®ç±»å‹

#### âŒ é”™è¯¯çš„é…ç½®

```
Run/Debug Configurations
â”œâ”€ Application
â”‚  â””â”€ DemoApplication  â† é”™è¯¯ï¼åº”è¯¥åˆ é™¤
```

#### âœ… æ­£ç¡®çš„é…ç½®

```
Run/Debug Configurations
â”œâ”€ Remote JVM Debug
â”‚  â””â”€ Remote Debug - Demo App via Proxy  â† æ­£ç¡®ï¼
```

### æ£€æŸ¥è¿è¡Œå‚æ•°

#### âŒ é”™è¯¯çš„å‚æ•°ï¼ˆæœ¬åœ°è°ƒè¯•ï¼‰

```bash
-agentlib:jdwp=transport=dt_socket,address=127.0.0.1:50214,suspend=y,server=n
                                                                    â†‘
                                                            è¿™æ˜¯é”™è¯¯çš„ï¼
```

#### âœ… æ­£ç¡®çš„å‚æ•°ï¼ˆè¿œç¨‹è°ƒè¯•ï¼‰

```bash
# demo-app å¯åŠ¨æ—¶çš„å‚æ•°ï¼ˆåœ¨ç»ˆç«¯ä¸­ï¼‰
-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=15006
                                         â†‘
                                    è¿™æ˜¯æ­£ç¡®çš„ï¼
```

---

## ğŸ¯ éªŒè¯é…ç½®æˆåŠŸ

### 1. ç»ˆç«¯éªŒè¯

```bash
# æŸ¥çœ‹æ‰€æœ‰ Java è¿›ç¨‹
jps -l

# åº”è¯¥çœ‹åˆ°ï¼š
88923 com.example.demo.DemoApplication           â† demo-app
88926 com.example.proxy.server.WebSocketDebugProxyServer
88929 com.example.proxy.client.WebSocketDebugProxyClient

# ä¸åº”è¯¥çœ‹åˆ°ä¸¤ä¸ª DemoApplicationï¼
```

### 2. ç«¯å£éªŒè¯

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :15006  # demo-app JDWP
lsof -i :18888  # proxy-server
lsof -i :15005  # proxy-client

# éƒ½åº”è¯¥æ˜¾ç¤ºè¿›ç¨‹åœ¨è¿è¡Œ
```

### 3. IDEA éªŒè¯

è¿æ¥æˆåŠŸåï¼ŒIDEA åº”è¯¥æ˜¾ç¤ºï¼š
```
Connected to the target VM, address: 'localhost:15005', transport: 'socket'
```

**ä¸åº”è¯¥æ˜¾ç¤º**ï¼š
```
Process finished with exit code 0
```

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### Q1: IDEA æ˜¾ç¤º "Unable to open debugger port"

**åŸå› **ï¼šç»„ä»¶æ²¡æœ‰å¯åŠ¨æˆ–ç«¯å£ä¸å¯¹

**è§£å†³**ï¼š
```bash
./check-status.sh
```

ç¡®ä¿ proxy-client åœ¨ 15005 ç«¯å£è¿è¡Œã€‚

### Q2: è¿æ¥åç«‹å³æ–­å¼€

**åŸå› **ï¼šé…ç½®ä¸º Application æ¨¡å¼ï¼Œä¸æ˜¯ Remote JVM Debug

**è§£å†³**ï¼š
1. åˆ é™¤ Application é…ç½®
2. é‡æ–°åˆ›å»º Remote JVM Debug é…ç½®

### Q3: æ–­ç‚¹ä¸ç”Ÿæ•ˆ

**åŸå› **ï¼šæºä»£ç å’Œè¿è¡Œçš„ class ä¸åŒ¹é…

**è§£å†³**ï¼š
```bash
# é‡æ–°ç¼–è¯‘ demo-app
cd demo-app
mvn clean package

# é‡å¯ demo-app
# ï¼ˆCtrl+C åœæ­¢ï¼Œç„¶åé‡æ–°è¿è¡Œ ./start-demo-app.shï¼‰
```

### Q4: çœ‹ä¸åˆ°åº”ç”¨è¾“å‡º

**åŸå› **ï¼šè¿œç¨‹è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œè¾“å‡ºä¸åœ¨ IDEA æ§åˆ¶å°

**è§£å†³**ï¼š
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f /tmp/demo-app.log
tail -f /tmp/demo-app-status.log
```

---

## ğŸ“Š é…ç½®å¯¹æ¯”è¡¨

| é¡¹ç›® | Application (é”™è¯¯) | Remote JVM Debug (æ­£ç¡®) |
|------|-------------------|------------------------|
| **é…ç½®ç±»å‹** | Application | Remote JVM Debug |
| **å¯åŠ¨æ–¹å¼** | IDEA å¯åŠ¨åº”ç”¨ | åº”ç”¨å·²åœ¨è¿è¡Œ |
| **JDWP å‚æ•°** | server=n | server=y |
| **è¿æ¥æ–¹å¼** | IDEA â†’ æœ¬åœ°åº”ç”¨ | IDEA â†’ Proxy â†’ è¿œç¨‹åº”ç”¨ |
| **åº”ç”¨ç”Ÿå‘½å‘¨æœŸ** | ç”± IDEA æ§åˆ¶ | ç‹¬ç«‹è¿è¡Œ |
| **æ–­å¼€å** | åº”ç”¨é€€å‡º | åº”ç”¨ç»§ç»­è¿è¡Œ |
| **è¾“å‡ºä½ç½®** | IDEA æ§åˆ¶å° | ç»ˆç«¯/æ—¥å¿—æ–‡ä»¶ |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä½¿ç”¨è„šæœ¬å¯åŠ¨

```bash
# ä¸€é”®å¯åŠ¨æ‰€æœ‰ç»„ä»¶
./start-all.sh

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯ç›‘æ§
tail -f /tmp/demo-app.log
```

### 2. ä½¿ç”¨ tmux æˆ– screen

```bash
# åˆ›å»ºå¤šä¸ªçª—å£ç®¡ç†ç»„ä»¶
tmux new-session -s debug

# çª—å£ 1: demo-app
./start-demo-app.sh

# çª—å£ 2: proxy-server (Ctrl+B, C åˆ›å»ºæ–°çª—å£)
cd debug-proxy-server && java -jar ...

# çª—å£ 3: proxy-client
cd debug-proxy-client && java -jar ...

# åˆ‡æ¢çª—å£: Ctrl+B, N (ä¸‹ä¸€ä¸ª) æˆ– P (ä¸Šä¸€ä¸ª)
```

### 3. åˆ›å»º IDEA å·¥ä½œæµ

1. å¯åŠ¨ç»„ä»¶ï¼ˆç»ˆç«¯ï¼‰
2. æ‰“å¼€ IDEA
3. è®¾ç½®æ–­ç‚¹
4. ç‚¹å‡» Debug
5. å¼€å§‹è°ƒè¯•

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `IDEA-DEBUG-GUIDE.md` - è°ƒè¯•åŸç†å’Œé—®é¢˜è¯Šæ–­
- `SIMPLE-GUIDE.md` - ç®€åŒ–ç‰ˆä½¿ç”¨æŒ‡å—
- `é—®é¢˜ä¿®å¤æ€»ç»“.md` - å¸¸è§é—®é¢˜ä¿®å¤

---

**è®°ä½ï¼šè¿œç¨‹è°ƒè¯• = è¿æ¥åˆ°å·²è¿è¡Œçš„åº”ç”¨ï¼Œä¸æ˜¯è®© IDEA å¯åŠ¨åº”ç”¨ï¼**

